"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function setLigacaoAttributes(){return call.dddOrigin=Number(dddOrigin.value),call.dddDestination=Number(dddDestination.value),call.time=Number(time.value),call.plan=Number(planSelect.value),call.pricePerMinute=getPrice(),call.tax=getTax(),mountBenchmark(),!1}function goTo(t){window.scroll(0,document.querySelector("#"+t).offsetTop-100)}function sendContact(){return postRequest("api/calls",{contactName:contactName.value,email:email.value,messages:[{date:new Date,content:message.value}]},snackbarAnimation),!1}function postRequest(t,e,n){var i=new XMLHttpRequest;return i.onreadystatechange=function(){4==this.readyState&&200==this.status&&n()},i.open("POST","api/contact",!0),i.setRequestHeader("Content-type","application/json"),i.send(JSON.stringify(e)),!1}function snackbarAnimation(){snackbar.classList.add("show"),setTimeout(function(){return snackbar.classList.remove("show")},3e3)}function getRequest(t,e,n){var i=new XMLHttpRequest;i.onreadystatechange=function(){4==this.readyState&&200==this.status&&(params[e]=JSON.parse(i.responseText),n())},i.open("GET",t,!0),i.send()}function getPrice(){var t=dddOrigin.value,e=dddDestination.value;return params.calls.filter(function(e){return e.dddOrigin==t})[0].dddDestinations.filter(function(t){return t.ddd==e})[0].pricePerMinute}function getTax(){var t=plan.value;return params.plans.filter(function(e){return e.value==t})[0].tax}function mountDDDOptions(){params.calls.forEach(function(t){dddOrigin.add(new Option(0+String(t.dddOrigin),t.dddOrigin,!1)),dddDestination.add(new Option(0+String(t.dddOrigin),t.dddOrigin,!1))})}function mountPlansOptions(){params.plans.forEach(function(t){planSelect.add(new Option(t.text,t.value,!1))})}function mountBenchmark(){faleMaisPrice.textContent=call.faleMaisPrice.toLocaleString("pt-BR",{minimumFractionDigits:2}),defaultPrice.textContent=call.defaultPrice.toLocaleString("pt-BR",{minimumFractionDigits:2}),withFaleMais.classList.remove("better","worst"),withoutFaleMais.classList.remove("better","worst"),call.faleMaisPrice<=call.defaultPrice?(withFaleMais.classList.add("better"),withoutFaleMais.classList.add("worst")):(withFaleMais.classList.add("worst"),withoutFaleMais.classList.add("better"))}function manageDestination(t){removeDestinations(),addDestination(t.target.value)}function removeDestinations(){document.querySelectorAll("#ddd_destination option:not(:first-child)").forEach(function(t){t.remove()}),dddDestination.selectedIndex=null}function addDestination(t){params.calls.filter(function(e){return e.dddOrigin==t})[0].dddDestinations.forEach(function(t){dddDestination.add(new Option(0+String(t.ddd),t.ddd,!1))})}var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),Call=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";_classCallCheck(this,t),this._dddOrigin=e,this._dddDestination=n,this._time=i,this._plan=a,this._pricePerMinute=r,this._tax=s}return _createClass(t,[{key:"dddOrigin",get:function(){return this._dddOrigin},set:function(t){return this._dddOrigin=t,this}},{key:"tax",get:function(){return this._tax},set:function(t){return this._tax=t,this}},{key:"dddDestination",get:function(){return this._dddDestination},set:function(t){return this._dddDestination=t,this}},{key:"time",get:function(){return this._time},set:function(t){return this._time=t,this}},{key:"plan",get:function(){return this._plan},set:function(t){return this._plan=t,this}},{key:"pricePerMinute",get:function(){return this._pricePerMinute},set:function(t){return this._pricePerMinute=t,this}},{key:"defaultPrice",get:function(){return this.time*this.pricePerMinute}},{key:"faleMaisPrice",get:function(){return this.time<=this.plan?0:(this.time-this.plan)*(this.pricePerMinute+this.pricePerMinute*this.tax)}}]),t}(),call=new Call,dddOrigin=document.querySelector("#ddd_origin"),dddDestination=document.querySelector("#ddd_destination"),time=document.querySelector("#time"),contactName=document.querySelector("#contact_name"),email=document.querySelector("#email"),message=document.querySelector("#message"),faleMaisPrice=document.querySelector("#with_falemais_price"),defaultPrice=document.querySelector("#without_falemais_price"),withFaleMais=document.querySelector(".with.falemais"),withoutFaleMais=document.querySelector(".without.falemais"),planSelect=document.querySelector("#plan"),snackbar=document.querySelector(".snackbar"),params={calls:null,plans:null};window.onload=function(){getRequest("api/calls","calls",mountDDDOptions),getRequest("api/plans","plans",mountPlansOptions),document.querySelector("#simulation-form").onsubmit=setLigacaoAttributes,document.querySelector("#contact-form").onsubmit=sendContact,document.querySelector("#ddd_origin").onchange=manageDestination};